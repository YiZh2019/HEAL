---
title: "check age HH"
author: "Yi"
date: "6/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(haven)
```

```{r}
HH <- read.csv("/Users/zhan039/Desktop/USC_HEAL/CHS/FL temp/HH_W1_to_W8_Scored_061120.csv", stringsAsFactors = F, na.strings = c("NA", " "))
```

```{r}
CalcAge <- function(surveydate, birthdate) {
  Birthdate_new <- as.Date(HH[, birthdate], format = "%m/%d/%y")
  Surveydate_new <- as.Date(HH[, surveydate], format = "%m/%d/%y")
  
  age <- trunc(as.numeric(difftime(Surveydate_new, Birthdate_new, units = "days")/365.2422))
  
  return(age)
}
```


```{r W1}
HH$W1_Age_Calc_new <- CalcAge("W1_Survey_Date", "Birthdate")

select(HH, Birthdate, W1_Survey_Date, W1_DEM_Age, W1_Age_by_Birth_New, W1_Age_Calc_new)
```

```{r W2}
HH$W2_Age_Calc_new <- CalcAge("W2_Survey_Date", "Birthdate")


select(HH, Birthdate, W2_Survey_Date, W2_Age_by_Birth_New, W2_Age_Calc_new)
```

```{r W3}
HH$W3_Age_Calc_new <- CalcAge("W3_Survey_Date", "Birthdate")

select(HH, Birthdate, W3_Survey_Date, W3_Age_by_Birth_New, W3_Age_Calc_new)
```

```{r W4}
HH$W4_Age_Calc_new <- CalcAge("W4_Survey_Date", "Birthdate")

select(HH, Birthdate, W4_Survey_Date, W4_Age_by_Birth_New, W4_Age_Calc_new)
```

```{r W5}
HH$W5_Age_Calc_new <- CalcAge("W5_Survey_Date", "Birthdate")

select(HH, Birthdate, W5_Survey_Date, W5_Age_by_Birth_New, W5_Age_Calc_new)
```

```{r W6}
HH$W6_Age_Calc_new <- CalcAge("W6_Survey_Date", "Birthdate")

select(HH, Birthdate, W6_Survey_Date, W6_Age_by_Birth_New, W6_Age_Calc_new)
```

```{r W7}
HH$W7_Age_Calc_new <- CalcAge("W7_Survey_Date", "Birthdate")

select(HH, Birthdate, W7_Survey_Date, W7_Age_by_Birth_New, W7_Age_Calc_new)
```

```{r W8}
HH$W8_Age_Calc_new <- CalcAge("W8_Survey_Date", "Birthdate")

select(HH, Birthdate, W8_Survey_Date, W8_Age_by_Birth_New, W8_Age_Calc_new)
```

```{r summary}
apply(HH[, c("W1_Age_Calc_new", "W2_Age_Calc_new", "W3_Age_Calc_new", "W4_Age_Calc_new", "W5_Age_Calc_new", "W6_Age_Calc_new", "W7_Age_Calc_new", "W8_Age_Calc_new")], 2, summary)
```


```{r}
write.csv(x = HH, file = "/Users/zhan039/Desktop/USC_HEAL/CHS/Yi/06232020/HH_06252020.csv")

write_sav(HH, "/Users/zhan039/Desktop/USC_HEAL/CHS/Yi/06232020/HH_06252020.sav")
```

